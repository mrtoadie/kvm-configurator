// internal/ui/error.go
// last modification: January 26 2026
package ui

import (
	"fmt"
	"os"
	"errors"
)

/*
var (
	// General configuration issues
	ErrConfigMissing   = errors.New("Configuration file not found")
	ErrConfigInvalid   = errors.New("Configuration file invalid or corrupt") // not used yet
	ErrWorkDirInvalid  = errors.New("Cannot resolve work directory")

	// Prerequisite issues
	ErrVirtInstallMissing = errors.New("â€virt-installâ€œ not in $PATH") // not used yet
	ErrVirshMissing       = errors.New("â€œvirshâ€ not in $PATH") // not used yet

	// VM creation issues
	ErrISONotFound      = errors.New("ISO file not accessible") // not used yet
	ErrDiskCreationFail = errors.New("Disk argument could not be constructed") // not used yet
	ErrVirtInstallFail  = errors.New("virt-install failed") // not used yet
	ErrVirshDefineFail  = errors.New("virsh define failed") // not used yet
	ErrVMCreationFail		= errors.New("VM creation failed")

	//
	ErrSelection	= errors.New("Invalid Selection!")
)
*/

var (
	// General configuration issues
	ErrConfigMissing = errors.New("â—ï¸ Configuration file not found â€“ did you forget to summon the wizard?")
	ErrConfigInvalid = errors.New("âš ï¸ Configuration file corrupted â€“ looks like a gremlin ate the YAML.")
	ErrWorkDirInvalid = errors.New("ğŸ“ Cannot resolve work directory â€“ are you stuck in a maze?")

	// Prerequisite issues
	ErrVirtInstallMissing = errors.New("ğŸš€ â€œvirtâ€‘installâ€ not in $PATH â€“ your system is missing its rocket fuel.")
	ErrVirshMissing       = errors.New("ğŸ”§ â€œvirshâ€ not in $PATH â€“ you need a toolbox, not a treasure chest.")

	// VM creation issues
	ErrISONotFound      = errors.New("ğŸ’¿ ISO file not accessible â€“ maybe itâ€™s playing hideâ€‘andâ€‘seek.")
	ErrDiskCreationFail = errors.New("ğŸ—„ï¸ Disk argument could not be constructed â€“ the disk is shy today.")
	ErrVirtInstallFail  = errors.New("âš™ï¸ virtâ€‘install failed â€“ the gears are jammed.")
	ErrVirshDefineFail  = errors.New("ğŸ“œ virsh define failed â€“ the script refused to sign the contract.")
	ErrVMCreationFail   = errors.New("ğŸ‘¾ VM creation failed â€“ the virtual gremlins struck again.")

	// Misc
	ErrSelection = errors.New("â“ Invalid selection â€“ choose wisely, young Padawan.")
)

/* --------------------
	Helper function: Format and output errors with context
	Report outputs a nicely colored error.
	* ctx* â€“ short context text (e.g., â€œVM creationâ€)
	* err* â€“ the actual error (can be one of the predefined ones)
-------------------- */
// Report gibt einen Kontextâ€‘String zusammen mit dem eigentlichen Fehler aus
// und fÃ¤rbt die komplette Zeile rot (Errorâ€‘Alias).
func Report(ctx string, err error) {
    if err == nil {
        return
    }
    // Wir bauen den Text erst und Ã¼bergeben ihn dann an den farbigen Wrapper.
    // Errorf sorgt automatisch fÃ¼r das Prefixâ€‘/Suffixâ€‘Escapeâ€‘Sequenz.
    msg := Errorf("%s: %v", ctx, err)
    fmt.Fprintln(os.Stderr, msg)
}

/* --------------------
	Uniform error message + exit
	example: ui.Fatal(err, "Error loading file-config")
-------------------- */
func Fatal(err error, ctx string) {
	if err != nil {
		Report(ctx, err)
		os.Exit(1)
	}
}

func WarnSoft(err error, ctx string) {
    if err != nil {
        // Gelbe Warnung â†’ Promptâ€‘Alias (kann bei Bedarf ein eigener Alias werden)
        msg := Promptf("%s %v", ctx, err)
        fmt.Fprintln(os.Stderr, msg)
    }
}

//TEST
func ReportVirshDefine(err error) {
    if err != nil {
        // Rot, aber mit extra PrÃ¤fix
        msg := Errorf("virsh define failed: %v", err)
        fmt.Fprintln(os.Stderr, msg)
    }
}